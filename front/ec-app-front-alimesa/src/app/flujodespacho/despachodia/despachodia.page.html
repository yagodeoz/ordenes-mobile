<ion-header class="osahan-nav">
    <ion-toolbar>
        <ion-buttons slot="start">
            <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title>Lista de Despachos realizados
        </ion-title>
    </ion-toolbar>
</ion-header>
<ion-content class="ion-padding order-list-page" color="light">
    <ion-searchbar class="p-0 mb-2" placeholder="Buscar despacho por Nombre..."  #buscadorCliente
    [animated]="true" (keyup.enter)="buscarCliente(buscadorCliente.value)"
></ion-searchbar>
    <div class="text-center mb-2"><small>Fecha: {{fechaHoy}} </small></div>
    
    <div class="card order-item-card mb-2" *ngFor=" let item of listaDespachos ">
        <div class="d-flex align-items-center p-3">
            <div class="overflow-hidden ml-2">
                <h6 class="font-weight-bold text-dark mb-0 text-truncate">{{item.razonsocialcomprador}}</h6>
                <div class="text-truncate text-primary">Identificación: {{item.identificacioncomprador}}</div>
                <div class="text-truncate text-primary">Dire.: {{item.direccioncomprador}}</div>
                <div class="small text-secondary">
                    <ion-icon name="cart-outline"></ion-icon>
                    Referencia despacho : {{item.idreferencia}}
                </div>
                <div class="small text-secondary">
                    <ion-icon name="cart-outline"></ion-icon>
                    Referencia órden : {{item.numerooden}}
                </div>
                <div class="small text-secondary">
                    <ion-icon name="pricetag-outline"></ion-icon>
                    Referencia Factura : {{item.numerofactura}}
                </div>
                <div class="small text-secondary">
                    <ion-icon name="calendar-outline"></ion-icon>
                    Fecha Emisión : {{item.fechaemision  | date: 'dd/MM/yyyy' }}
                </div>
            </div>
        </div>
        <div class="d-flex align-items-center py-2 px-3 border-top border-bottom text-success">
            {{item.estadoproceso}} - Canal {{item.canalcreacion}}  
            <ion-icon class="ml-auto" name="close-circle-outline"></ion-icon>
        </div>
        <div class="p-3">
            <div class="d-flex justify-content-between mb-1">
                <small class="text-secondary">Total Sin Impuestos </small>
                <small class="text-secondary">{{item.totalsinimpuestos  | currency}}</small>
            </div>
            <div class="d-flex justify-content-between mb-3">
                <small class="text-secondary">Total a Pagar</small>
                <small class="text-secondary">{{item.importetotal  | currency}}</small>
            </div>
            <ion-grid style="padding: 0px !important;">
                <ion-row style="padding: 0px !important;" >
                    <ion-col >
                        <ion-button class="button-block mb-0 mx-0"  color="danger" (click)='imprimir(item)'  >Comprobante</ion-button>
                      </ion-col>
                  <ion-col>
                    <ion-button class="button-block mb-0 mx-0"  color="primary"  (click)='procesarDespacho(item)'  >Ver detalles</ion-button>
                  </ion-col>    
                </ion-row>
            </ion-grid>    
        </div>
    </div>
</ion-content>